/*
 * lexical-analyzer 1.0.0
 * A generic lexical analysis tool.
 * https://github.com/royswastik/lambda-calculus-evaluator#readme
 *
 * Copyright 2018, Swastik Roy
 * Released under the LGPL-3.0 license.
*/

InputReader=function(){function e(e){for(var r=0;r<e.length;r++)if("="==e[r])return{name:e.substring(0,r).trim(),value:e.substring(r+1,e.length).trim()};return!1}return{readRegex:e,readRegexArray:function(r){for(var t=[],n=0;n<r.length;n++)t.push(e(r[n]));return t}}}(),Lexer=function(){var e="",r=[],t=[],n=[];return{init:function(n,a){e=n;var u=JSON.parse(JSON.stringify(a)),s=RegPreprocessor.preProcess(u);return s.err?s:(t=RegexMatcher.getRegexPatternArray(s),r=t,1)},GetToken:function(t){return t||(t=function(e){}),0!=n.length?arr.splice(-1,1):function(t){var n="",a=!1;if(0==e.length)return{eof:!0};for(var u=0;u<e.length;u++){var s=e[u];n+=s;var c=RegexMatcher.getPotentialSet(n,r),i=RegexMatcher.matchRegex(n,c);if(i&&((a=Token(n,i)).index=u),0==c.length)break}return a?(e=e.substring(a.index+1,e.length),delete a.index,a):(t("Lexical Error"),!1)}(t)},UnGetToken:function(e){n.push(e)}}}(),Token=function(e,r,t){return{lexeme:e,type:r,lineNo:t}},regexChars=["+","(",")",".","*","|"],PreProcessError=function(e){return{err:!0,message:e}},RegularExpression=function(e,r){return{value:e,name:r}},RegPreprocessor=function(){return{preProcess:function(e){for(var r=e,t=0;t<e.length;t++)for(var n=e[t],a=!0;a;){a=!1;for(var u=0;u<e.length;u++){var s=new RegExp(e[u].name);if(s.test(n.value)){if(t==u)return PreProcessError("Error: Recursive definition for "+e[u].name);n.value=n.value.replace(s,"("+e[u].value+")"),a=!0,r[t]=RegularExpression(n.value,n.name)}}}return r}}}(),RegexMatcher=function(){function e(e,r){for(var t=e,n=0;n<regexChars.length;n++){var a=regexChars[n];t=t.replace(new RegExp("\\"+a),"\\"+a)}var u=new RegExp(r),s=new RegExp("^"+u.toPartialMatchRegex().source+"$","i"),c=e.match(s),i=!1;if(!c)return!1;for(n=0;n<c.length;n++){var o=c[n];o&&0!=o.length&&e.startsWith(o)&&(i=!0)}return i}function r(e,r){return function(e,r){var t=new RegExp(r),n=e.match(t),a=!1;if(!n)return;for(var u=0;u<n.length;u++)n[u]==e&&(a=!0);return a}(e,r)}return{getPotentialSet:function(r,t){for(var n=[],a=0;a<t.length;a++)e(r,t[a].value)&&n.push(t[a]);return n},isPotential:e,isMatch:r,matchRegex:function(e,t){for(var n=0;n<t.length;n++)if(r(e,t[n].value))return t[n];return!1},getRegexPatternArray:function(e){for(var r=[],t="",n=0;n<e.length;n++)t=(t=(t=e[n].value.replace(/\s/g,"")).replace(/\t/g,"")).replace(/\+/g,"|"),r.push(RegularExpression(t,e[n].name));return r}}}(),RegExp.prototype.toPartialMatchRegex=function(){"use strict";var e=this,r=this.source,t=0;function n(){var a,u="";function s(e){u+=r.substr(t,e),t+=e}function c(e){u+="(?:"+r.substr(t,e)+"|$)",t+=e}for(;t<r.length;)switch(r[t]){case"\\":switch(r[t+1]){case"c":c(3);break;case"x":c(4);break;case"u":e.unicode?"{"===r[t+2]?c(r.indexOf("}",t)-t+1):c(6):c(2);break;default:c(2)}break;case"[":(a=/\[(?:\\.|.)*?\]/g).lastIndex=t,c((a=a.exec(r))[0].length);break;case"|":case"^":case"$":case"*":case"+":case"?":s(1);break;case"{":(a=/\{\d+,?\d*\}/g).lastIndex=t,(a=a.exec(r))?s(a[0].length):c(1);break;case"(":if("?"==r[t+1])switch(r[t+2]){case":":u+="(?:",t+=3,u+=n()+"|$)";break;case"=":u+="(?=",t+=3,u+=n()+")";break;case"!":a=t,t+=3,n(),u+=r.substr(a,t-a)}else s(1),u+=n()+"|$)";break;case")":return++t,u;default:c(1)}return u}return new RegExp(n(),this.flags)};